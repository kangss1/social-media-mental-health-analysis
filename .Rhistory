print(summary_df)
# Line plot (selected genes)
selected_genes <- c("YAL001C", "YAL014C", "YAL016W", "YAL020C", "YAL022C")
subset_line_data <- long_data[long_data$time %in% selected_genes, ]
ggplot(subset_line_data, aes(x = as.numeric(as.character(Time)), y = Expression, color = time)) +
geom_line() +
geom_point(size = 1) +
theme_minimal() +
labs(title = "Line Plot of Gene Expression Over Time (Selected Genes)",
x = "Time (Minutes)", y = "Log-Ratio Expression")
# Boxplot across time
ggplot(long_data, aes(x = Time, y = Expression)) +
geom_boxplot(fill = "lightblue", outlier.color = "red", outlier.size = 0.5) +
theme_minimal() +
labs(title = "Boxplot of Gene Expression Across Time Points",
x = "Time (Minutes)", y = "Log-Ratio Expression")
# Heatmap: 100 random genes
set.seed(2025)
sample_genes <- sample(unique(long_data$time), 100)
heat_data <- long_data[long_data$time %in% sample_genes, ]
heat_data_wide <- pivot_wider(heat_data, names_from = Time, values_from = Expression)
rownames(heat_data_wide) <- heat_data_wide$time
heat_matrix <- as.matrix(heat_data_wide[, -1])
heatmap(heat_matrix, Rowv = NA, Colv = NA, scale = "row",
col = colorRampPalette(c("blue", "white", "red"))(100),
main = "Heatmap of Gene Expression (100 Genes X Time)")
# Correlation matrix
time_data <- spellman_data[, grep("^X", colnames(spellman_data))]
cor_matrix <- cor(time_data)
print(round(cor_matrix[1:10, 1:10], 2))
# Multiple regression model
model_time <- lm(Expression ~ Time, data = long_data)
summary_model <- summary(model_time)
print(summary_model)
# R-squared values
print(summary_model$r.squared)
print(summary_model$adj.r.squared)
# Significant coefficients
coef_table <- summary_model$coefficients
sig_coef <- coef_table[coef_table[,4] < 0.05, ]
print(sig_coef)
# Diagnostics
par(mfrow = c(1, 2))
plot(model_time$fitted.values, model_time$residuals,
main = "Residuals vs Fitted",
xlab = "Fitted Values", ylab = "Residuals",
pch = 16, col = "steelblue")
abline(h = 0, col = "red")
qqnorm(model_time$residuals, main = "Q-Q Plot of Residuals",
pch = 16, col = "darkgreen")
qqline(model_time$residuals, col = "red", lwd = 2)
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(reshape2)
library(pheatmap)
base_dir <- getwd()
data_path <- file.path(base_dir, "../data/Spellman.csv")
if (!file.exists(data_path)) {
stop("Spellman.csv not found in /data directory.")
}
spellman_data <- read.csv(data_path, stringsAsFactors = FALSE)
dim(spellman_data)
sum(is.na(spellman_data))
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(reshape2)
library(pheatmap)
base_dir <- getwd()
data_path <- file.path(base_dir, "../data/Spellman.csv")
if (!file.exists(data_path)) {
stop("Spellman.csv not found in /data directory.")
}
spellman_data <- read.csv(data_path, stringsAsFactors = FALSE)
dim(spellman_data)
sum(is.na(spellman_data))
knitr::opts_chunk$set(echo = TRUE, warning = FALSE, message = FALSE)
library(tidyverse)
library(reshape2)
library(pheatmap)
base_dir <- getwd()
data_path <- file.path(base_dir, "../data/Spellman.csv")
if (!file.exists(data_path)) {
stop("Spellman.csv not found in /data directory.")
}
spellman_data <- read.csv(data_path, stringsAsFactors = FALSE)
dim(spellman_data)
sum(is.na(spellman_data))
possible_gene_cols <- names(spellman_data)[!grepl("^X", names(spellman_data))]
gene_col <- possible_gene_cols[1]
cat("Detected gene column:", gene_col, "\n")
long_data <- spellman_data %>%
pivot_longer(
cols = starts_with("X"),
names_to = "Time",
values_to = "Expression"
)
names(long_data)[names(long_data) == gene_col] <- "Gene"
long_data$Time <- as.numeric(gsub("X", "", long_data$Time))
head(long_data)
summary_df <- long_data %>%
group_by(Time) %>%
summarise(
Mean = mean(Expression, na.rm = TRUE),
Median = median(Expression, na.rm = TRUE),
SD = sd(Expression, na.rm = TRUE)
)
summary_df
selected_genes <- head(unique(long_data$Gene), 5)
subset_line_data <- long_data %>% filter(Gene %in% selected_genes)
ggplot(subset_line_data, aes(x = Time, y = Expression, color = Gene, group = Gene)) +
geom_line(linewidth = 1.0, alpha = 0.9) +
geom_point(size = 1.8) +
theme_minimal() +
labs(
title = "Gene Expression Over Time (Selected Genes)",
x = "Time (Minutes)",
y = "Log-Ratio Expression"
)
ggplot(long_data, aes(x = factor(Time), y = Expression)) +
geom_boxplot(fill = "lightblue", outlier.color = "red", outlier.size = 0.5) +
theme_minimal() +
labs(
title = "Boxplot of Gene Expression Across Time Points",
x = "Time (Minutes)",
y = "Log-Ratio Expression"
)
set.seed(2025)
gene_index <- sample(1:nrow(spellman_data), min(100, nrow(spellman_data)))
heat_data <- spellman_data[gene_index, grep("^X", colnames(spellman_data))]
rownames(heat_data) <- spellman_data[gene_index, gene_col]
pheatmap(
as.matrix(heat_data),
scale = "row",
color = colorRampPalette(c("blue", "white", "red"))(100),
main = "Heatmap of Gene Expression (100 Random Genes)"
)
time_data <- spellman_data[, grep("^X", colnames(spellman_data))]
cor_matrix <- cor(time_data, use = "pairwise.complete.obs")
round(cor_matrix[1:10, 1:10], 2)
model_time <- lm(Expression ~ Time, data = long_data)
summary(model_time)
par(mfrow = c(1, 2))
plot(model_time$fitted.values, model_time$residuals,
main = "Residuals vs Fitted",
xlab = "Fitted Values", ylab = "Residuals",
pch = 16, col = "steelblue")
abline(h = 0, col = "red")
qqnorm(model_time$residuals,
main = "Q-Q Plot of Residuals",
pch = 16, col = "darkgreen")
qqline(model_time$residuals, col = "red", lwd = 2)
sessionInfo()
# Install these only once
#install.packages(c("tidyverse", "corrplot"))
# Load libraries
library(tidyverse)    # data wrangling + ggplot2
library(corrplot)     # correlation heatmap
## 1. Data Transformation ##
# Load dataset
data <- read.csv("smmh.csv", stringsAsFactors = FALSE)
# Install these only once
#install.packages(c("tidyverse", "corrplot"))
# Load libraries
library(tidyverse)    # data wrangling + ggplot2
library(corrplot)     # correlation heatmap
## 1. Data Transformation ##
# Load dataset
data <- read.csv("smmh.csv", stringsAsFactors = FALSE)
# Install these only once
#install.packages(c("tidyverse", "corrplot"))
# Load libraries
library(tidyverse)    # data wrangling + ggplot2
library(corrplot)     # correlation heatmap
## 1. Data Transformation ##
# Load dataset
data <- read.csv("smmh.csv", stringsAsFactors = FALSE)
# Install these only once
#install.packages(c("tidyverse", "corrplot"))
# Load libraries
library(tidyverse)    # data wrangling + ggplot2
library(corrplot)     # correlation heatmap
## 1. Data Transformation ##
# Load dataset
data <- read.csv("smmh.csv", stringsAsFactors = FALSE)
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/IUPUI/Course Archive/Data Mining INFO I421/Group Project")
# Install these only once
#install.packages(c("tidyverse", "corrplot"))
# Load libraries
library(tidyverse)    # data wrangling + ggplot2
library(corrplot)     # correlation heatmap
## 1. Data Transformation ##
# Load dataset
data <- read.csv("smmh.csv", stringsAsFactors = FALSE)
# Define time categories
time_labels <- c("Less than 1 hour", "Between 1 and 2 hours", "Between 2 and 3 hours",
"Between 3 and 4 hours", "Between 4 and 5 hours", "More than 5 hours")
# 6. Use Social Media
data[[7]] <- as.factor(data[[7]])
colnames(data)[7] <- "Use_SM"
# 7. Platforms Used
colnames(data)[8] <- "Platforms_used"
# 8. Time Spent on Social Media
data$Time_spent_raw <- data[[9]]
# Replace NA and mark non-users
data$Time_spent_raw[data$Use_SM == "No"] <- "Not Use SM"
data$Time_spent_raw[is.na(data$Time_spent_raw)] <- "Not Use SM"
# Factor for plotting
full_labels <- c(time_labels, "Not Use SM")
data$Time_spent_label <- factor(data$Time_spent_raw,
levels = full_labels,
labels = c("Less than 1h", "1–2h", "2–3h", "3–4h", "4–5h", "More than 5h", "Not Use SM"),
ordered = FALSE)
# Numeric for modeling (set NA for non-users)
data$Time_spent <- as.numeric(factor(ifelse(data$Time_spent_label == "Not Use SM", NA, as.character(data$Time_spent_label)),
levels = c("Less than 1h", "1–2h", "2–3h", "3–4h", "4–5h", "More than 5h"),
ordered = TRUE))
# 9. No Purpose Use
data[[10]] <- as.numeric(data[[10]])
colnames(data)[10] <- "No_purpose_use"
# Mental Health Metrics
data[[13]] <- as.numeric(data[[13]]); colnames(data)[13] <- "Easily_distracted"
data[[14]] <- as.numeric(data[[14]]); colnames(data)[14] <- "Anxiety_score"
data[[19]] <- as.numeric(data[[19]]); colnames(data)[19] <- "Depression_score"
data[[21]] <- as.numeric(data[[21]]); colnames(data)[21] <- "Sleep_issues"
# Demographics
data[[2]] <- as.numeric(data[[2]]); colnames(data)[2] <- "Age"
data[[3]] <- as.factor(data[[3]]); colnames(data)[3] <- "Gender"
data[[5]] <- as.factor(data[[5]]); colnames(data)[5] <- "Employment_status"
# Binary outcome
data$High_Depression <- factor(ifelse(data$Depression_score >= 4, "Yes", "No"))
## 2. Correlation + Simple Regressions ##
# Correlations and R²
for (metric in c("Depression_score", "Anxiety_score", "Easily_distracted", "Sleep_issues")) {
for (predictor in c("Time_spent", "No_purpose_use")) {
r <- cor(data[[predictor]], data[[metric]], use = "complete.obs")
cat(paste("cor(", predictor, ",", metric, ") = ", round(r, 3), ", R² = ", round(r^2, 3), "\n"))
}
}
# Regressions
models <- list(
Depression = lm(Depression_score ~ Time_spent + No_purpose_use, data = data),
Anxiety = lm(Anxiety_score ~ Time_spent + No_purpose_use, data = data),
Distraction = lm(Easily_distracted ~ Time_spent + No_purpose_use, data = data),
Sleep = lm(Sleep_issues ~ Time_spent + No_purpose_use, data = data)
)
models2 <- list(
Depression = lm(Depression_score ~ Time_spent + No_purpose_use +
Age + Gender + Employment_status,
data = data),
Anxiety = lm(Anxiety_score ~ Time_spent + No_purpose_use +
Age + Gender + Employment_status,
data = data),
Distraction = lm(Easily_distracted ~ Time_spent + No_purpose_use +
Age + Gender + Employment_status,
data = data),
Sleep = lm(Sleep_issues ~ Time_spent + No_purpose_use +
Age + Gender + Employment_status,
data = data)
)
# Output model summaries
lapply(models, summary)
lapply(models2, summary)
# Regression & Correlation Findings – Narrative Summary
#
# The regression and correlation analysis reveals statistically significant relationships
# between social media usage patterns and several mental health indicators.
# Time spent on social media shows a modest but consistent positive correlation with
# depression, anxiety, and distraction scores, with coefficients ranging from 0.16 to 0.18
# and p-values well below 0.001. Notably, purposeless use of social media exhibits an even
# stronger relationship, particularly with depression and distraction, suggesting that
# not just how much, but how individuals engage with social media is critical.
# The strongest predictor in the model was purposeless use predicting distraction
# (R² = 0.134), indicating a potentially disruptive influence on attention and cognitive control.
# While the correlation with sleep issues was weaker and not statistically significant for
# time spent, purposeless use remained a moderate predictor of disrupted sleep patterns.
# Together, these findings support the hypothesis that increased and aimless engagement
# with social media is associated with elevated psychological distress,
# particularly in the form of depression and attentional difficulties.
## 3. Visualizations ##
# a. Boxplots
# Depression
ggplot(data %>% filter(!is.na(Time_spent_label)),
aes(x = Time_spent_label, y = Depression_score)) +
geom_boxplot(fill = "lightblue") +
labs(title = "Depression Score by Time Spent on Social Media",
x = "Time Spent Category", y = "Depression Score") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Interpretation:
# Similar to anxiety, depression scores are higher for those using social media more.
# “Not Use SM” participants report notably lower depression scores (1–2).
#adds weight to the argument that frequency of use matters.
#Anxiety
ggplot(data %>% filter(!is.na(Time_spent_label)),
aes(x = Time_spent_label, y = Anxiety_score)) +
geom_boxplot(fill = "lightgreen") +
labs(title = "Anxiety Score by Time Spent on Social Media",
x = "Time Spent Category", y = "Anxiety Score") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Interpretation:
# Median anxiety scores rise with more social media time.
# “Not Use SM” group shows significantly lower anxiety, reinforcing the contrast.
# Consistent upward pattern implies dose-response: more time = higher anxiety.
# b. Histograms - These histograms help contextualize who the “average user” is in this sample.
# Depression Distribution
ggplot(data, aes(x = Depression_score)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "black") +
labs(title = "Distribution of Depression Scores")
# Depression scores are centered around 3–5, indicating moderate to high levels
# across respondents whom are mostly social media users.
# Time Spent Distribution
ggplot(data, aes(x = Time_spent)) +
geom_histogram(binwidth = 1, fill = "orange", color = "black") +
labs(title = "Distribution of Time Spent on Social Media")
# Most people spend 2–5+ hours on social media, emphasizing how common high use is.
# c. Scatterplots with Regression Lines
# Time vs Anxiety
ggplot(data, aes(x = Time_spent, y = Anxiety_score)) +
geom_jitter(alpha = 0.4) +
geom_smooth(method = "lm", color = "red") +
labs(title = "Time Spent vs Anxiety Score")
# Time vs Depression
ggplot(data, aes(x = Time_spent, y = Depression_score)) +
geom_jitter(alpha = 0.4) +
geom_smooth(method = "lm", color = "blue") +
labs(title = "Time Spent vs Depression Score")
#Interpretation:
# Both plots show a positive slope: as time increases, so do anxiety and depression scores.
# There’s scatter, but the trendline confirms the regression outputs.
#While correlations are moderate, they are statistically significant.
# d. Bar Chart – High Depression Rate
data %>%
filter(!is.na(Time_spent)) %>%
group_by(Time_spent_label) %>%
summarise(High_Depression_Rate = mean(High_Depression == "Yes")) %>%
ggplot(aes(x = Time_spent_label, y = High_Depression_Rate)) +
geom_col(fill = "darkred") +
labs(title = "Rate of High Depression by Time Spent",
x = "Time Spent Category", y = "Proportion with High Depression") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
#Interpretation:
# Individuals who spend more time on social media report a higher rate of high depression symptoms.
# The proportion of high depression increases steadily from about 26% to over 60%, indicating a strong visual trend.
#Supports the hypothesis: more time = greater mental health risks.
# e. Heatmap – Mental Health Correlation
# Select relevant numeric vars
iv_dv_data <- data[, c("Time_spent", "No_purpose_use", "Depression_score", "Anxiety_score", "Easily_distracted", "Sleep_issues")]
# Compute correlations
cor_matrix_iv_dv <- cor(iv_dv_data, use = "complete.obs")
# Subset: IVs vs DVs
cor_matrix_iv_dv_subset <- cor_matrix_iv_dv[c("Time_spent", "No_purpose_use"),
c("Depression_score", "Anxiety_score", "Easily_distracted", "Sleep_issues")]
# Plot
corrplot(cor_matrix_iv_dv_subset,
method = "color",
addCoef.col = "black",
is.corr = TRUE,
tl.col = "black",
tl.cex = 0.9,
cl.cex = 0.8,
title = "Correlation: Social Media Use vs Mental Health Outcomes",
mar = c(0, 0, 2, 0))
#Interpretation:
# Time spent has modest positive correlations (0.24) with:
#  Depression
#  Anxiety
#  Distraction
# "No purpose use" correlates strongest with distraction (0.32), depression (0.25), and sleep issues (0.23).
# Conclusion
#
# This study set out to examine the relationship between social media usage patterns
# and various mental health indicators, including depression, anxiety, distraction,
# and sleep disturbances. Using survey-based data from a sample of social media users,
# we focused specifically on time spent on social media and frequency of purposeless use
# to understand their potential impact on mental well-being.
#
# The analysis revealed consistent, statistically significant relationships between
# social media use—especially purposeless engagement—and negative mental health outcomes.
# We found that purposeless use was the strongest predictor of distraction and depression,
# suggesting that the nature of engagement matters as much, if not more, than duration.
# These results validate the research design choice to focus on self-reported, behavior-specific
# measures of use (e.g., purposeless scrolling) over broader platform-level metrics.
#
# From a practical standpoint, the findings support initiatives aimed at promoting more
# mindful digital habits, as well as interventions or design strategies that help users
# reduce passive consumption. Theoretically, our results contribute to the growing body
# of literature on digital well-being by highlighting the role of usage intention in
# psychological health.
#
# However, the study has limitations. The self-reported nature of the data introduces
# potential biases, and the cross-sectional design limits causal interpretations.
# Future research should consider incorporating longitudinal data and experimental designs
# to strengthen causal claims. Additionally, including qualitative responses or physiological
# data could enrich understanding. Despite these limitations, the study provides valuable
# insights into the nuanced ways that social media use affects mental health, offering
# clear direction for both future research and practical application.
library(tidyverse)
library(corrplot)
# setwd("path/to/social-media-mental-health-analysis")
library(tidyverse)
library(corrplot)
# setwd("path/to/social-media-mental-health-analysis")
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/IUPUI/GitHub/social-media-mental-health-analysis")
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/IUPUI/GitHub/social-media-mental-health-analysis/data")
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
setwd("~/Library/Mobile Documents/com~apple~CloudDocs/IUPUI/GitHub/social-media-mental-health-analysis")
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
library(tidyverse)
library(corrplot)
# setwd("path/to/social-media-mental-health-analysis")
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
setwd("/Users/sandeepk/Library/Mobile Documents/com~apple~CloudDocs/IUPUI/GitHub/social-media-mental-health-analysis")
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
install.packages("here")
library(here)
data <- read.csv(here("data", "smmh.csv"), stringsAsFactors = FALSE)
library(tidyverse)
library(corrplot)
# setwd("path/to/social-media-mental-health-analysis")
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
getwd()
list.files()
list.files("data")
# Data load check
if (file.exists("data/smmh.csv")) {
data <- read.csv("data/smmh.csv", stringsAsFactors = FALSE)
cat("✅ Data loaded successfully. Dimensions:", dim(data)[1], "rows ×", dim(data)[2], "columns\n")
} else {
cat("⚠️ Data file not found. Please check that 'data/smmh.csv' exists in the project directory.\n")
}
data <- read.csv("/Users/sandeepk/Library/Mobile Documents/com~apple~CloudDocs/IUPUI/GitHub/social-media-mental-health-analysis/data/smmh.csv", stringsAsFactors = FALSE)
head(data)
dim(data)
time_labels <- c("Less than 1 hour", "Between 1 and 2 hours", "Between 2 and 3 hours",
"Between 3 and 4 hours", "Between 4 and 5 hours", "More than 5 hours")
data[[7]] <- as.factor(data[[7]])
colnames(data)[7] <- "Use_SM"
colnames(data)[8] <- "Platforms_used"
data$Time_spent_raw <- data[[9]]
data$Time_spent_raw[data$Use_SM == "No"] <- "Not Use SM"
data$Time_spent_raw[is.na(data$Time_spent_raw)] <- "Not Use SM"
data$Time_spent_label <- factor(data$Time_spent_raw,
levels = c(time_labels, "Not Use SM"),
labels = c("Less than 1h", "1–2h", "2–3h", "3–4h", "4–5h", "More than 5h", "Not Use SM"))
data$Time_spent <- as.numeric(factor(ifelse(data$Time_spent_label == "Not Use SM", NA, as.character(data$Time_spent_label)),
levels = c("Less than 1h", "1–2h", "2–3h", "3–4h", "4–5h", "More than 5h")))
data[[10]] <- as.numeric(data[[10]]); colnames(data)[10] <- "No_purpose_use"
data[[13]] <- as.numeric(data[[13]]); colnames(data)[13] <- "Easily_distracted"
data[[14]] <- as.numeric(data[[14]]); colnames(data)[14] <- "Anxiety_score"
data[[19]] <- as.numeric(data[[19]]); colnames(data)[19] <- "Depression_score"
data[[21]] <- as.numeric(data[[21]]); colnames(data)[21] <- "Sleep_issues"
data[[2]] <- as.numeric(data[[2]]); colnames(data)[2] <- "Age"
data[[3]] <- as.factor(data[[3]]); colnames(data)[3] <- "Gender"
data[[5]] <- as.factor(data[[5]]); colnames(data)[5] <- "Employment_status"
data$High_Depression <- factor(ifelse(data$Depression_score >= 4, "Yes", "No"))
summary(data)
iv_dv_data <- data[, c("Time_spent", "No_purpose_use", "Depression_score", "Anxiety_score", "Easily_distracted", "Sleep_issues")]
cor_matrix <- cor(iv_dv_data, use = "complete.obs")
cor_matrix
models <- list(
Depression = lm(Depression_score ~ Time_spent + No_purpose_use, data = data),
Anxiety = lm(Anxiety_score ~ Time_spent + No_purpose_use, data = data),
Distraction = lm(Easily_distracted ~ Time_spent + No_purpose_use, data = data),
Sleep = lm(Sleep_issues ~ Time_spent + No_purpose_use, data = data)
)
models2 <- list(
Depression = lm(Depression_score ~ Time_spent + No_purpose_use + Age + Gender + Employment_status, data = data),
Anxiety = lm(Anxiety_score ~ Time_spent + No_purpose_use + Age + Gender + Employment_status, data = data),
Distraction = lm(Easily_distracted ~ Time_spent + No_purpose_use + Age + Gender + Employment_status, data = data),
Sleep = lm(Sleep_issues ~ Time_spent + No_purpose_use + Age + Gender + Employment_status, data = data)
)
summary(models$Depression)
summary(models2$Depression)
ggplot(data %>% filter(!is.na(Time_spent_label)),
aes(x = Time_spent_label, y = Depression_score)) +
geom_boxplot(fill = "lightblue") +
labs(title = "Depression Score by Time Spent on Social Media",
x = "Time Spent Category", y = "Depression Score") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data %>% filter(!is.na(Time_spent_label)),
aes(x = Time_spent_label, y = Anxiety_score)) +
geom_boxplot(fill = "lightgreen") +
labs(title = "Anxiety Score by Time Spent on Social Media",
x = "Time Spent Category", y = "Anxiety Score") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
ggplot(data, aes(x = Depression_score)) +
geom_histogram(binwidth = 1, fill = "steelblue", color = "black") +
labs(title = "Distribution of Depression Scores")
ggplot(data, aes(x = Time_spent)) +
geom_histogram(binwidth = 1, fill = "orange", color = "black") +
labs(title = "Distribution of Time Spent on Social Media")
ggplot(data, aes(x = Time_spent, y = Anxiety_score)) +
geom_jitter(alpha = 0.4) +
geom_smooth(method = "lm", color = "red") +
labs(title = "Time Spent vs Anxiety Score")
ggplot(data, aes(x = Time_spent, y = Depression_score)) +
geom_jitter(alpha = 0.4) +
geom_smooth(method = "lm", color = "blue") +
labs(title = "Time Spent vs Depression Score")
data %>%
filter(!is.na(Time_spent)) %>%
group_by(Time_spent_label) %>%
summarise(High_Depression_Rate = mean(High_Depression == "Yes")) %>%
ggplot(aes(x = Time_spent_label, y = High_Depression_Rate)) +
geom_col(fill = "darkred") +
labs(title = "Rate of High Depression by Time Spent",
x = "Time Spent Category", y = "Proportion with High Depression") +
theme(axis.text.x = element_text(angle = 45, hjust = 1))
